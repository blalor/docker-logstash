## parse the good stuff in the http logs
filter {
    if [type] == "httpd_json" {
        useragent {
            source => "user_agent"
            prefix => "ua_"
        }
        
        ## strings to numbers
        mutate {
            convert => [
                "ua_os_major", "integer",
                "ua_os_minor", "integer",
                "ua_major", "integer",
                "ua_minor", "integer",
                "ua_patch", "integer"
            ]
        }
        
        geoip {
            source => "client"
        }
    }
}
