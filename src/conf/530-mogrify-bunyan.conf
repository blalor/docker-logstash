## fix up the Bunyan JSON logs
filter {
    if [type] == "bunyan" {
        date {
            match => [ "time",  "ISO8601" ]
            remove_field => [ "time" ]
            timezone => "Etc/UTC"
        }
        
        mutate {
            ## prepare to transform levels
            convert => [ "level", "string" ]
            
            ## remove unnecessary fields
            remove_field => [ "v" ]
            
            rename => [
                ## host also provided by logstash-forwarder; use the one from
                ## bunyan
                "hostname", "host",
                
                ## rename message field
                "msg", "message"
            ]
        }
        
        ## transform levels
        mutate {
            gsub => [
                "level", "60", "fatal",
                "level", "50", "error",
                "level", "40", "warn",
                "level", "30", "info",
                "level", "20", "debug",
                "level", "10", "trace"
            ]
        }
    }
}
    
