## email-as-json
filter {
    if [type] == "email" {
        mutate {
            ## consistent naming of message ID fields
            rename => { 
                "message-id" => "message_id"
            }
        }
        
        mutate {
            ## remove brackets from various fields
            gsub => [
                "message_id",  "[<>]", "",
                "return-path", "[<>]", "",
                "list-id",     "[<>]", ""
            ]
        }
    }
}
